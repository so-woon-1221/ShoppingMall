{"version":3,"file":"index.js","sources":["../src/lib/constants.ts","../src/lib/createScript.ts","../src/hooks/useNaverLogin.ts","../node_modules/rollup-plugin-styles/dist/runtime/inject-css.js","../src/components/NaverLogin.tsx"],"sourcesContent":["export const NAVER_SCRIPT_SRC = 'https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js';","type ScriptId = string;\r\nexport type CreateScript = (src: string) => Promise<ScriptId | any>;\r\n\r\nexport const createScript = (src) => {\r\n  return new Promise((resolve, reject) => {\r\n    if(document.getElementById(`async_script${src}`)) {\r\n      return reject();\r\n    }\r\n    const script: HTMLScriptElement = document.createElement('script');\r\n    script.id = `async_script_${src}`;\r\n    script.src = src;\r\n    script.addEventListener('load', () => resolve(script.id));\r\n    script.addEventListener('error', (response) => reject(response));\r\n\r\n    document.body.appendChild(script);\r\n  })\r\n}","import * as React from 'react';\r\nimport {INaverLoginProperties} from '../@types/naverLogin';\r\nimport {NAVER_SCRIPT_SRC} from '../lib/constants';\r\nimport { createScript } from '../lib/createScript';\r\n\r\ndeclare global {\r\n  interface Window {\r\n    naver: any\r\n  }\r\n}\r\n \r\ntype TNaverLogin = any;\r\n\r\ninterface IUserNaverLoginResult {\r\n  loading: boolean;\r\n  naverLoginInit: () =>TNaverLogin\r\n}\r\n\r\ntype TUserNaverLogin = (parameter: INaverLoginProperties) => null | IUserNaverLoginResult;\r\n\r\nconst useNaverLogin:TUserNaverLogin = ({\r\n  clientId,\r\n  callbackUrl,\r\n  isPopup,\r\n  loginButton = {color: \"green\", type: 2, height: 42},\r\n  callbackHandle = true\r\n}) => {\r\n  if(!('browser' in process)) {\r\n    return null;\r\n  }\r\n  const [isLoadedScript, setIsLoadedScript] = React.useState<boolean>(window?.naver?.LoginWithNaverId ? true : false);\r\n\r\n  const naverLoginInit = React.useCallback(() => {\r\n    if(isLoadedScript) {\r\n      const naverLogin = new window.naver.LoginWithNaverId(\r\n        {\r\n          clientId,\r\n          callbackUrl,\r\n          isPopup,\r\n          loginButton,\r\n          callbackHandle\r\n        }\r\n      );\r\n\r\n      naverLogin.init();\r\n      return naverLogin;\r\n    }\r\n    \r\n    return null;\r\n  }, [isLoadedScript]);\r\n\r\n  React.useEffect(() => {\r\n    if(!isLoadedScript) {\r\n      createScript(NAVER_SCRIPT_SRC)\r\n        .then(() => {\r\n          setIsLoadedScript(true);  \r\n        })\r\n    }\r\n  }, [isLoadedScript]);\r\n  \r\n  return {\r\n    loading: !isLoadedScript,\r\n    naverLoginInit,\r\n  }\r\n};\r\n\r\nexport default useNaverLogin;","var e=[],t=[];function n(n,r){if(n&&\"undefined\"!=typeof document){var a,s=!0===r.prepend?\"prepend\":\"append\",d=!0===r.singleTag,i=\"string\"==typeof r.container?document.querySelector(r.container):document.getElementsByTagName(\"head\")[0];if(d){var u=e.indexOf(i);-1===u&&(u=e.push(i)-1,t[u]={}),a=t[u]&&t[u][s]?t[u][s]:t[u][s]=c()}else a=c();65279===n.charCodeAt(0)&&(n=n.substring(1)),a.styleSheet?a.styleSheet.cssText+=n:a.appendChild(document.createTextNode(n))}function c(){var e=document.createElement(\"style\");if(e.setAttribute(\"type\",\"text/css\"),r.attributes)for(var t=Object.keys(r.attributes),n=0;n<t.length;n++)e.setAttribute(t[n],r.attributes[t[n]]);var a=\"prepend\"===s?\"afterbegin\":\"beforeend\";return i.insertAdjacentElement(a,e),e}}export default n;\n","import * as React from 'react';\r\nimport {INaverLoginProperties} from '../@types/naverLogin';\r\nimport useNaverLogin from '../hooks/useNaverLogin';\r\nimport './default.css';\r\n\r\nconst NaverLogin: React.FC<INaverLoginProperties> = ({\r\n  clientId,\r\n  callbackUrl,\r\n  loginButton = {color: \"green\", type: 2, height: 42},\r\n  isPopup,\r\n  callbackHandle = true,\r\n  children\r\n}) => {\r\n  if(!('browser' in process)) {\r\n    return null;\r\n  }\r\n  const buttonRef = React.useRef<HTMLDivElement>(null);\r\n  const {naverLoginInit, loading} = useNaverLogin({\r\n    clientId,\r\n    callbackUrl,\r\n    loginButton,\r\n    isPopup,\r\n    callbackHandle\r\n  }) || {};\r\n  \r\n\r\n  React.useEffect(() => {\r\n    if(!loading && buttonRef.current) {\r\n      naverLoginInit && naverLoginInit();\r\n    }\r\n  }, [loading, buttonRef]);\r\n  \r\n  return (\r\n    <>\r\n      {children && (\r\n        <>\r\n          <div\r\n            onClick={() => {\r\n              const {current} = buttonRef;\r\n              if(current !== null) {\r\n                const a = current.querySelector('a');\r\n                if(a) a.click();\r\n              }\r\n            }}\r\n          >\r\n            {children}\r\n          </div>\r\n        </>  \r\n      )}\r\n      <div className={children ? 'hide' : ''}>\r\n        <div \r\n          id=\"naverIdLogin\"\r\n          ref={buttonRef}\r\n        />\r\n      </div>\r\n    </>\r\n  )\r\n};\r\n\r\nNaverLogin.displayName = 'NaverLogin';\r\nexport default React.memo(NaverLogin);\r\n\r\n"],"names":["NAVER_SCRIPT_SRC","createScript","src","Promise","resolve","reject","document","getElementById","script","createElement","id","addEventListener","response","body","appendChild","useNaverLogin","_a","clientId","callbackUrl","isPopup","_c","loginButton","color","type","height","_d","callbackHandle","process","_e","React.useState","window","naver","LoginWithNaverId","isLoadedScript","setIsLoadedScript","naverLoginInit","React.useCallback","naverLogin","init","React.useEffect","then","loading","e","t","n","r","a","s","prepend","d","singleTag","i","container","querySelector","getElementsByTagName","u","indexOf","push","c","charCodeAt","substring","styleSheet","cssText","createTextNode","setAttribute","attributes","Object","keys","length","insertAdjacentElement","NaverLogin","_b","children","buttonRef","React.useRef","current","React.createElement","onClick","click","className","ref","displayName","React.memo"],"mappings":"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"}